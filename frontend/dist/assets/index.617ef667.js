(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function b(){}function se(t){return t()}function K(){return Object.create(null)}function U(t){t.forEach(se)}function le(t){return typeof t=="function"}function v(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let M;function R(t,e){return M||(M=document.createElement("a")),M.href=e,t===M.href}function ae(t){return Object.keys(t).length===0}function de(t,...e){if(t==null)return b;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function H(t,e,n){t.$$.on_destroy.push(de(e,n))}function h(t,e){t.appendChild(e)}function y(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function ue(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function _(t){return document.createElement(t)}function L(t){return document.createTextNode(t)}function w(){return L(" ")}function pe(){return L("")}function J(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function d(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function me(t){return Array.from(t.childNodes)}function ce(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function G(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e){r.selected=!0;return}}t.selectedIndex=-1}function he(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function Q(t,e,n){t.classList[n?"add":"remove"](e)}let X;function k(t){X=t}const S=[],B=[],q=[],V=[],_e=Promise.resolve();let F=!1;function ge(){F||(F=!0,_e.then(fe))}function W(t){q.push(t)}const x=new Set;let j=0;function fe(){const t=X;do{for(;j<S.length;){const e=S[j];j++,k(e),be(e.$$)}for(k(null),S.length=0,j=0;B.length;)B.pop()();for(let e=0;e<q.length;e+=1){const n=q[e];x.has(n)||(x.add(n),n())}q.length=0}while(S.length);for(;V.length;)V.pop()();F=!1,x.clear(),k(t)}function be(t){if(t.fragment!==null){t.update(),U(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(W)}}const P=new Set;let ye;function C(t,e){t&&t.i&&(P.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(P.has(t))return;P.add(t),ye.c.push(()=>{P.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function I(t){t&&t.c()}function E(t,e,n,r){const{fragment:o,on_mount:l,on_destroy:i,after_update:s}=t.$$;o&&o.m(e,n),r||W(()=>{const u=l.map(se).filter(le);i?i.push(...u):U(u),t.$$.on_mount=[]}),s.forEach(W)}function D(t,e){const n=t.$$;n.fragment!==null&&(U(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function we(t,e){t.$$.dirty[0]===-1&&(S.push(t),ge(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(t,e,n,r,o,l,i,s=[-1]){const u=X;k(t);const c=t.$$={fragment:null,ctx:null,props:l,update:b,not_equal:o,bound:K(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:K(),dirty:s,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let a=!1;if(c.ctx=n?n(t,e.props||{},(f,p,...m)=>{const A=m.length?m[0]:p;return c.ctx&&o(c.ctx[f],c.ctx[f]=A)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](A),a&&we(t,f)),p}):[],c.update(),a=!0,U(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const f=me(e.target);c.fragment&&c.fragment.l(f),f.forEach(g)}else c.fragment&&c.fragment.c();e.intro&&C(t.$$.fragment),E(t,e.target,e.anchor,e.customElement),fe()}k(u)}class T{$destroy(){D(this,1),this.$destroy=b}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!ae(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const $=[];function $e(t,e=b){let n;const r=new Set;function o(s){if(v(t,s)&&(t=s,n)){const u=!$.length;for(const c of r)c[1](),$.push(c,t);if(u){for(let c=0;c<$.length;c+=2)$[c][0]($[c+1]);$.length=0}}}function l(s){o(s(t))}function i(s,u=b){const c=[s,u];return r.add(c),r.size===1&&(n=e(o)||b),s(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:o,update:l,subscribe:i}}const Y=document.getElementById("static-host").innerText,ve=t=>({upload:{url:"/upload"}})[t],Se=({form:t,data:e})=>{let n;return t?(n=new FormData(t),{body:n}):e?(n=JSON.stringify(e),{body:n,headers:{"Content-Type":"application/json"}}):{}},ke=({dataSet:t,form:e,data:n,method:r="POST"})=>o=>(async()=>{const{url:l}=ve(t);o(f=>({...f,loading:!0}));const i=Se({form:e,data:n}),s=await fetch(l,{method:r,...i}).catch(f=>new Error(f));if(s instanceof Error){o(f=>({...f,loading:!1,error:s}));return}const u=await s.json().catch(f=>new Error(f)),{detail:c,message:a}=u;o(f=>({...f,loading:!1,...u instanceof Error?{error:u}:c||a?{error:c||a}:{data:u,error:!1}}))})(),Ce="upload";class Ee{constructor(e){this.dataSet=e;const{subscribe:n,set:r,update:o}=$e({loading:!1,data:null});this.subscribe=n,this.set=r,this.update=o}reset(){this.set({loading:!1,data:null})}async loadData({...e}={}){await ke({dataSet:this.dataSet,...e})(this.update)}getData(){let e;return this.subscribe(n=>e=n)(),e}}class De extends Ee{constructor(){super(Ce)}extractData(){const{data:e}=this.getData(),{counter:n=[],stopwords:r=[]}=e||{};this.update(o=>({...o,counter:n,stopwords:r}))}checkCounter(){const{counter:e=[],stopwords:n=[]}=this.getData(),r=Math.max(...e.map(l=>l[1])),o=e.map(l=>({active:n.indexOf(l[0])>-1,text:l[0],size:Math.round(l[1]/r*100)/100}));this.update(l=>({...l,counterChecked:o}))}async loadAndCheck({...e}){await this.loadData({...e}),this.extractData(),this.checkCounter()}updateStopwords(e,n){let{stopwords:r=[]}=this.getData();r=n(r,e),this.update(o=>({...o,stopwords:r})),this.checkCounter()}addStopword(e){this.updateStopwords(e,(n,r)=>[...new Set([...n,r])])}removeStopword(e){this.updateStopwords(e,(n,r)=>[...n.filter(o=>o!==r)])}}const O=new De;function Z(t,e,n){const r=t.slice();return r[0]=e[n][0],r[5]=e[n][1],r}function ee(t){let e,n=t[5]+"",r;return{c(){e=_("option"),r=L(n),e.__value=t[0],e.value=e.__value},m(o,l){y(o,e,l),h(e,r)},p:b,d(o){o&&g(e)}}}function Oe(t){let e,n,r,o,l,i=t[2],s=[];for(let u=0;u<i.length;u+=1)s[u]=ee(Z(t,i,u));return{c(){e=_("input"),n=w(),r=_("select");for(let u=0;u<s.length;u+=1)s[u].c();d(e,"name",t[1]),e.value=t[0],e.hidden=!0,d(r,"name",t[1]),d(r,"id","language"),t[0]===void 0&&W(()=>t[3].call(r))},m(u,c){y(u,e,c),y(u,n,c),y(u,r,c);for(let a=0;a<s.length;a+=1)s[a].m(r,null);G(r,t[0]),o||(l=J(r,"change",t[3]),o=!0)},p(u,[c]){if(c&2&&d(e,"name",u[1]),c&5&&e.value!==u[0]&&(e.value=u[0]),c&4){i=u[2];let a;for(a=0;a<i.length;a+=1){const f=Z(u,i,a);s[a]?s[a].p(f,c):(s[a]=ee(f),s[a].c(),s[a].m(r,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}c&2&&d(r,"name",u[1]),c&5&&G(r,u[0])},i:b,o:b,d(u){u&&g(e),u&&g(n),u&&g(r),ue(s,u),o=!1,l()}}}function Le(t,e,n){const r={lang:[["en","English"],["ru","\u0420\u0443\u0441\u0441\u043A\u0438\u0439"]]};let{name:o="lang"}=e;const l=r[o];let{value:i=l[0][0]}=e;function s(){i=he(this),n(0,i),n(2,l)}return t.$$set=u=>{"name"in u&&n(1,o=u.name),"value"in u&&n(0,i=u.value)},[i,o,l,s]}class Ne extends T{constructor(e){super(),N(this,e,Le,Oe,v,{name:1,value:0})}}function Te(t){let e,n,r,o,l,i,s,u,c,a,f;return o=new Ne({props:{name:"lang"}}),{c(){e=_("form"),n=_("input"),r=w(),I(o.$$.fragment),l=w(),i=_("input"),s=w(),u=_("input"),d(n,"name","text_file"),d(n,"type","file"),d(i,"name","stopwords"),i.value=t[1],d(i,"type","text"),i.hidden=!0,d(u,"type","submit"),d(e,"action",""),d(e,"enctype","multipart/form-data")},m(p,m){y(p,e,m),h(e,n),h(e,r),E(o,e,null),h(e,l),h(e,i),h(e,s),h(e,u),t[4](e),c=!0,a||(f=J(u,"click",t[2]),a=!0)},p(p,[m]){(!c||m&2&&i.value!==p[1])&&(i.value=p[1])},i(p){c||(C(o.$$.fragment,p),c=!0)},o(p){z(o.$$.fragment,p),c=!1},d(p){p&&g(e),D(o),t[4](null),a=!1,f()}}}function Ae(t,e,n){let r,o;H(t,O,u=>n(3,o=u));let l;const i=async u=>{u.preventDefault(),await O.loadAndCheck({form:l})};function s(u){B[u?"unshift":"push"](()=>{l=u,n(0,l)})}return t.$$.update=()=>{t.$$.dirty&8&&n(1,r=JSON.stringify(o.stopwords)||"[]")},[l,r,i,o,s]}class Me extends T{constructor(e){super(),N(this,e,Ae,Te,v,{})}}function te(t,e,n){const r=t.slice();return r[3]=e[n].active,r[4]=e[n].text,r[5]=e[n].size,r}function ne(t){let e,n=t[4]+"",r,o,l;return{c(){e=_("span"),r=L(n),d(e,"class","stop-word svelte-1lvcmi"),d(e,"style","font-size=2em"),Q(e,"active",t[3])},m(i,s){y(i,e,s),h(e,r),o||(l=J(e,"click",function(){le(t[1]({active:t[3],text:t[4]}))&&t[1]({active:t[3],text:t[4]}).apply(this,arguments)}),o=!0)},p(i,s){t=i,s&1&&n!==(n=t[4]+"")&&ce(r,n),s&1&&Q(e,"active",t[3])},d(i){i&&g(e),o=!1,l()}}}function je(t){let e,n=t[0],r=[];for(let o=0;o<n.length;o+=1)r[o]=ne(te(t,n,o));return{c(){e=_("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","stop-words svelte-1lvcmi")},m(o,l){y(o,e,l);for(let i=0;i<r.length;i+=1)r[i].m(e,null)},p(o,[l]){if(l&3){n=o[0];let i;for(i=0;i<n.length;i+=1){const s=te(o,n,i);r[i]?r[i].p(s,l):(r[i]=ne(s),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:b,o:b,d(o){o&&g(e),ue(r,o)}}}function qe(t,e,n){let r,o;H(t,O,i=>n(2,o=i));const l=({active:i,text:s})=>u=>O[i?"removeStopword":"addStopword"](s);return t.$$.update=()=>{t.$$.dirty&4&&n(0,r=o.counterChecked||[])},[r,l,o]}class Pe extends T{constructor(e){super(),N(this,e,qe,je,v,{})}}function re(t){let e;return{c(){e=_("p"),e.textContent="Loading..."},m(n,r){y(n,e,r)},d(n){n&&g(e)}}}function oe(t){let e,n;return{c(){e=_("p"),n=L(t[0])},m(r,o){y(r,e,o),h(e,n)},p(r,o){o&1&&ce(n,r[0])},d(r){r&&g(e)}}}function ie(t){let e,n;return{c(){e=_("img"),R(e.src,n=Y+"/"+t[1])||d(e,"src",n),d(e,"alt","Word cloud")},m(r,o){y(r,e,o)},p(r,o){o&2&&!R(e.src,n=Y+"/"+r[1])&&d(e,"src",n)},d(r){r&&g(e)}}}function ze(t){let e,n,r,o=t[2]&&re(),l=t[0]&&oe(t),i=t[1]&&ie(t);return{c(){o&&o.c(),e=w(),l&&l.c(),n=w(),i&&i.c(),r=pe()},m(s,u){o&&o.m(s,u),y(s,e,u),l&&l.m(s,u),y(s,n,u),i&&i.m(s,u),y(s,r,u)},p(s,[u]){s[2]?o||(o=re(),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),s[0]?l?l.p(s,u):(l=oe(s),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),s[1]?i?i.p(s,u):(i=ie(s),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i:b,o:b,d(s){o&&o.d(s),s&&g(e),l&&l.d(s),s&&g(n),i&&i.d(s),s&&g(r)}}}function Ie(t,e,n){let r,o,l,i,s;return H(t,O,u=>n(4,s=u)),t.$$.update=()=>{t.$$.dirty&16&&n(2,r=s.loading),t.$$.dirty&16&&n(3,o=s.data||{}),t.$$.dirty&8&&n(1,l=o.wcloud),t.$$.dirty&16&&n(0,i=s.error)},[i,l,r,o,s]}class We extends T{constructor(e){super(),N(this,e,Ie,ze,v,{})}}function Ue(t){let e,n,r,o,l,i,s,u,c,a,f,p;return s=new We({}),c=new Me({}),f=new Pe({}),{c(){e=_("main"),n=_("div"),n.innerHTML="<p>Upload text file (TXT or XML, incl. HTML)</p>",r=w(),o=_("h1"),o.textContent="Word Cloud",l=w(),i=_("div"),I(s.$$.fragment),u=w(),I(c.$$.fragment),a=w(),I(f.$$.fragment),d(i,"class","card")},m(m,A){y(m,e,A),h(e,n),h(e,r),h(e,o),h(e,l),h(e,i),E(s,i,null),h(e,u),E(c,e,null),h(e,a),E(f,e,null),p=!0},p:b,i(m){p||(C(s.$$.fragment,m),C(c.$$.fragment,m),C(f.$$.fragment,m),p=!0)},o(m){z(s.$$.fragment,m),z(c.$$.fragment,m),z(f.$$.fragment,m),p=!1},d(m){m&&g(e),D(s),D(c),D(f)}}}class xe extends T{constructor(e){super(),N(this,e,null,Ue,v,{})}}new xe({target:document.getElementById("app")});
//# sourceMappingURL=index.617ef667.js.map
